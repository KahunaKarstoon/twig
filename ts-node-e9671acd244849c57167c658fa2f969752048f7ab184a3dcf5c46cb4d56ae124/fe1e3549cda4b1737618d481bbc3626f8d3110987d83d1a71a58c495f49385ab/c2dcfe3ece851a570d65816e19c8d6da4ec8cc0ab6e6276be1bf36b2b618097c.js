"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var protractor_1 = require("protractor");
var app_po_1 = require("../PageObjects/app.po");
var utils_1 = require("../utils");
describe('Events and Sequences', function () {
    var page;
    beforeAll(function () {
        page = new app_po_1.TwigPage();
        page.navigateTo();
        page.user.loginDefaultTestUser();
        page.header.twigletTab.deleteTwigletIfNeeded(utils_1.twigletName, page);
        protractor_1.browser.waitForAngular();
        utils_1.createDefaultJsonImportedTwiglet(page);
        protractor_1.browser.waitForAngular();
    });
    afterAll(function () {
        // browser.manage().logs().get('browser').then(function(browserLog) {
        //   console.log('log: ' + require('util').inspect(browserLog));
        // });
        utils_1.deleteDefaultJsonImportedTwiglet(page);
    });
    describe('Adding an event', function () {
        beforeAll(function () {
            page.accordion.goToMenu('Events');
        });
        it('pops up the create event modal', function () {
            page.accordion.eventsMenu.startNewEventProcess();
            expect(page.formForModals.modalTitle).toEqual('Create New Event');
        });
        it('makes sure event names are unique', function () {
            page.formForModals.fillInTextFieldByLabel('Name', 'event1');
            expect(page.formForModals.getErrorByLabel('Name')).toEqual('Names must be unique.');
        });
        it('can save the event', function () {
            page.formForModals.fillInTextFieldByLabel('Name', 'event3');
            page.formForModals.clickButton('Create');
            page.formForModals.waitForModalToClose();
            page.formForModals.waitForModalToClose();
            expect(page.formForModals.isModalOpen).toBeFalsy();
        });
        it('adds the event', function () {
            expect(page.accordion.eventsMenu.eventCount).toEqual(3);
        });
    });
    describe('Previewing an event', function () {
        beforeAll(function () {
            protractor_1.browser.waitForAngular();
            page.header.twigletEditTab.startTwigletEditProcess();
            page.header.twigletEditTab.addNodeByTooltip('ent1');
            page.formForModals.fillInTextFieldByLabel('Name', 'node 1');
            page.formForModals.clickButton('Add Node');
            page.formForModals.waitForModalToClose();
            page.header.twigletEditTab.saveEdits();
            page.formForModals.fillInOnlyTextField('Commit message');
            page.formForModals.clickButton('Save Changes');
            page.formForModals.waitForModalToClose();
            page.accordion.goToMenu('Events');
        });
        it('shows the correct number of nodes for event', function () {
            page.accordion.eventsMenu.previewEvent('event2');
            expect(page.twigletGraph.nodeCount).toEqual(15);
            page.accordion.eventsMenu.previewEvent('event2');
        });
    });
    describe('Creating a sequence', function () {
        it('can create a sequence', function () {
            page.accordion.eventsMenu.startNewEventProcess();
            page.formForModals.fillInTextFieldByLabel('Name', 'event4');
            page.formForModals.clickButton('Create');
            page.formForModals.waitForModalToClose();
            page.accordion.eventsMenu.toggleEventCheck('event1');
            page.accordion.eventsMenu.toggleEventCheck('event3');
            page.accordion.eventsMenu.startNewSequenceProcess();
            expect(page.formForModals.modalTitle).toEqual('Create New Sequence');
        });
        it('makes sure event sequence names are unique', function () {
            page.formForModals.fillInTextFieldByLabel('Name', 'sequence1');
            expect(page.formForModals.getErrorByLabel('Name')).toEqual('Names must be unique.');
        });
        it('can save the sequence', function () {
            page.formForModals.fillInTextFieldByLabel('Name', 'sequence2');
            page.formForModals.clickButton('Create');
            page.formForModals.waitForModalToClose();
            expect(page.formForModals.isModalOpen).toBeFalsy();
        });
        it('sequence list should display the correct number of sequences', function () {
            expect(page.accordion.eventsMenu.sequenceCount).toEqual(2);
        });
    });
    describe('Viewing a sequence', function () {
        it('shows the correct checked events', function () {
            expect(page.accordion.eventsMenu.checkedEvent('event3')).toBeTruthy();
        });
        it('ends the play sequence and displays current twiglet', function () {
            page.accordion.eventsMenu.startSequencePlay();
            page.accordion.eventsMenu.waitForPlayback();
            expect(page.twigletGraph.linkCount).toEqual(15);
        });
    });
    describe('Overwriting a sequence', function () {
        it('brings up the save sequence modal when save is clicked', function () {
            page.accordion.eventsMenu.startViewSequenceProcess('sequence2');
            page.accordion.eventsMenu.toggleEventCheck('event1');
            page.accordion.eventsMenu.startSaveSequenceProcess('sequence2');
            expect(page.formForModals.modalTitle).toEqual('Edit Sequence');
        });
        it('closes the modal when submit is clicked', function () {
            page.formForModals.clickButton('Save Changes');
            page.formForModals.waitForModalToClose();
            protractor_1.browser.waitForAngular();
            expect(page.formForModals.isModalOpen).toBeFalsy();
        });
        it('shows the updated checked events', function () {
            page.accordion.eventsMenu.startViewSequenceProcess('sequence2');
            expect(page.accordion.eventsMenu.checkedEvent('event3')).toBeFalsy();
        });
    });
    describe('Deleting an event', function () {
        beforeAll(function () {
            page.accordion.goToMenu('Events');
        });
        it('disables the delete button if event is in sequence', function () {
            expect(page.accordion.eventsMenu.checkIfDeleteEnabled('event1')).toBeTruthy();
        });
        it('can bring up the delete event modal', function () {
            page.accordion.eventsMenu.startDeleteEventProcess('event4');
            expect(page.formForModals.modalTitle).toEqual('Delete event4');
        });
        it('disables the "Delete" button if the name does not match', function () {
            expect(page.formForModals.checkIfButtonEnabled('Delete')).toBeFalsy();
        });
        it('enables the button if the form is filled out correctly', function () {
            page.formForModals.fillInOnlyTextField('event4');
            expect(page.formForModals.checkIfButtonEnabled('Delete')).toBeTruthy();
        });
        it('should close the modal when the Delete button is pressed', function () {
            page.formForModals.clickButton('Delete');
            page.formForModals.waitForModalToClose();
            expect(page.formForModals.isModalOpen).toBeFalsy();
        });
        it('deletes the event', function () {
            expect(page.accordion.eventsMenu.eventCount).toEqual(3);
        });
    });
    describe('Deleting a sequence', function () {
        beforeAll(function () {
            page.accordion.goToMenu('Events');
        });
        it('can bring up the delete sequence modal', function () {
            page.accordion.eventsMenu.startDeleteSequenceProcess('sequence2');
            expect(page.formForModals.modalTitle).toEqual('Delete sequence2');
        });
        it('disables the "Delete" button if the name does not match', function () {
            expect(page.formForModals.checkIfButtonEnabled('Delete')).toBeFalsy();
        });
        it('enables the button if the form is filled out correctly', function () {
            page.formForModals.fillInOnlyTextField('sequence2');
            expect(page.formForModals.checkIfButtonEnabled('Delete')).toBeTruthy();
        });
        it('should close the modal when the Delete button is pressed', function () {
            page.formForModals.clickButton('Delete');
            page.formForModals.waitForModalToClose();
            expect(page.formForModals.isModalOpen).toBeFalsy();
        });
        it('deletes the sequence', function () {
            expect(page.accordion.eventsMenu.sequenceCount).toEqual(1);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL3R3aWcvZTJlL2pvdXJuZXlzL3R3aWdsZXQtZXZlbnRzLmUyZS1zcGVjLnRzIiwic291cmNlcyI6WyIvdHdpZy9lMmUvam91cm5leXMvdHdpZ2xldC1ldmVudHMuZTJlLXNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx5Q0FBcUM7QUFFckMsZ0RBQWlEO0FBQ2pELGtDQUlrQjtBQUVsQixRQUFRLENBQUMsc0JBQXNCLEVBQUU7SUFDL0IsSUFBSSxJQUFjLENBQUM7SUFFbkIsU0FBUyxDQUFDO1FBQ1IsSUFBSSxHQUFHLElBQUksaUJBQVEsRUFBRSxDQUFDO1FBQ3RCLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNsQixJQUFJLENBQUMsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7UUFDakMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMscUJBQXFCLENBQUMsbUJBQVcsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNoRSxvQkFBTyxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQ3pCLHdDQUFnQyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3ZDLG9CQUFPLENBQUMsY0FBYyxFQUFFLENBQUM7SUFDM0IsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUM7UUFDUCxxRUFBcUU7UUFDckUsZ0VBQWdFO1FBQ2hFLE1BQU07UUFDTix3Q0FBZ0MsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN6QyxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxpQkFBaUIsRUFBRTtRQUMxQixTQUFTLENBQUM7WUFDUixJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxnQ0FBZ0MsRUFBRTtZQUNuQyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1lBQ2pELE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1FBQ3BFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG1DQUFtQyxFQUFFO1lBQ3RDLElBQUksQ0FBQyxhQUFhLENBQUMsc0JBQXNCLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBQzVELE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1FBQ3RGLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG9CQUFvQixFQUFFO1lBQ3ZCLElBQUksQ0FBQyxhQUFhLENBQUMsc0JBQXNCLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBQzVELElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3pDLElBQUksQ0FBQyxhQUFhLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztZQUN6QyxJQUFJLENBQUMsYUFBYSxDQUFDLG1CQUFtQixFQUFFLENBQUM7WUFDekMsTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDckQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0JBQWdCLEVBQUU7WUFDbkIsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMxRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHFCQUFxQixFQUFFO1FBQzlCLFNBQVMsQ0FBQztZQUNSLG9CQUFPLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDekIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsdUJBQXVCLEVBQUUsQ0FBQztZQUNyRCxJQUFJLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUNwRCxJQUFJLENBQUMsYUFBYSxDQUFDLHNCQUFzQixDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQztZQUM1RCxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUMzQyxJQUFJLENBQUMsYUFBYSxDQUFDLG1CQUFtQixFQUFFLENBQUM7WUFDekMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsU0FBUyxFQUFFLENBQUM7WUFDdkMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQ3pELElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBQy9DLElBQUksQ0FBQyxhQUFhLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztZQUN6QyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRTtZQUNoRCxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDakQsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsU0FBUyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ2hELElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNuRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHFCQUFxQixFQUFFO1FBQzlCLEVBQUUsQ0FBQyx1QkFBdUIsRUFBRTtZQUMxQixJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1lBQ2pELElBQUksQ0FBQyxhQUFhLENBQUMsc0JBQXNCLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBQzVELElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3pDLElBQUksQ0FBQyxhQUFhLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztZQUN6QyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNyRCxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNyRCxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyx1QkFBdUIsRUFBRSxDQUFDO1lBQ3BELE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1FBQ3ZFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDRDQUE0QyxFQUFFO1lBQy9DLElBQUksQ0FBQyxhQUFhLENBQUMsc0JBQXNCLENBQUMsTUFBTSxFQUFFLFdBQVcsQ0FBQyxDQUFDO1lBQy9ELE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1FBQ3RGLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHVCQUF1QixFQUFFO1lBQzFCLElBQUksQ0FBQyxhQUFhLENBQUMsc0JBQXNCLENBQUMsTUFBTSxFQUFFLFdBQVcsQ0FBQyxDQUFDO1lBQy9ELElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3pDLElBQUksQ0FBQyxhQUFhLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztZQUN6QyxNQUFNLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw4REFBOEQsRUFBRTtZQUNqRSxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsYUFBYSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsb0JBQW9CLEVBQUU7UUFDN0IsRUFBRSxDQUFDLGtDQUFrQyxFQUFFO1lBQ3JDLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUN4RSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxxREFBcUQsRUFBRTtZQUN4RCxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1lBQzlDLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQzVDLE1BQU0sQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNsRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHdCQUF3QixFQUFFO1FBQ2pDLEVBQUUsQ0FBQyx3REFBd0QsRUFBRTtZQUMzRCxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyx3QkFBd0IsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUNoRSxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNyRCxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyx3QkFBd0IsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUNoRSxNQUFNLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQyxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDakUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMseUNBQXlDLEVBQUU7WUFDNUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDLENBQUM7WUFDL0MsSUFBSSxDQUFDLGFBQWEsQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO1lBQ3pDLG9CQUFPLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDekIsTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDckQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsa0NBQWtDLEVBQUU7WUFDckMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsd0JBQXdCLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDaEUsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ3ZFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsbUJBQW1CLEVBQUU7UUFDNUIsU0FBUyxDQUFDO1lBQ1IsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsb0RBQW9ELEVBQUU7WUFDdkQsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDaEYsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMscUNBQXFDLEVBQUU7WUFDeEMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsdUJBQXVCLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDNUQsTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQ2pFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlEQUF5RCxFQUFFO1lBQzVELE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDeEUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsd0RBQXdELEVBQUU7WUFDM0QsSUFBSSxDQUFDLGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNqRCxNQUFNLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ3pFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDBEQUEwRCxFQUFFO1lBQzdELElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3pDLElBQUksQ0FBQyxhQUFhLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztZQUN6QyxNQUFNLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxtQkFBbUIsRUFBRTtZQUN0QixNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzFELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMscUJBQXFCLEVBQUU7UUFDOUIsU0FBUyxDQUFDO1lBQ1IsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsd0NBQXdDLEVBQUU7WUFDM0MsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsMEJBQTBCLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDbEUsTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLENBQUMsT0FBTyxDQUFDLGtCQUFrQixDQUFDLENBQUM7UUFDcEUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMseURBQXlELEVBQUU7WUFDNUQsTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUN4RSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx3REFBd0QsRUFBRTtZQUMzRCxJQUFJLENBQUMsYUFBYSxDQUFDLG1CQUFtQixDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ3BELE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDekUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMERBQTBELEVBQUU7WUFDN0QsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDekMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO1lBQ3pDLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ3JELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHNCQUFzQixFQUFFO1lBQ3pCLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYnJvd3NlciB9IGZyb20gJ3Byb3RyYWN0b3InO1xuXG5pbXBvcnQgeyBUd2lnUGFnZSB9IGZyb20gJy4uL1BhZ2VPYmplY3RzL2FwcC5wbyc7XG5pbXBvcnQge1xuICBjcmVhdGVEZWZhdWx0SnNvbkltcG9ydGVkVHdpZ2xldCxcbiAgZGVsZXRlRGVmYXVsdEpzb25JbXBvcnRlZFR3aWdsZXQsXG4gIHR3aWdsZXROYW1lXG59IGZyb20gJy4uL3V0aWxzJztcblxuZGVzY3JpYmUoJ0V2ZW50cyBhbmQgU2VxdWVuY2VzJywgKCkgPT4ge1xuICBsZXQgcGFnZTogVHdpZ1BhZ2U7XG5cbiAgYmVmb3JlQWxsKCgpID0+IHtcbiAgICBwYWdlID0gbmV3IFR3aWdQYWdlKCk7XG4gICAgcGFnZS5uYXZpZ2F0ZVRvKCk7XG4gICAgcGFnZS51c2VyLmxvZ2luRGVmYXVsdFRlc3RVc2VyKCk7XG4gICAgcGFnZS5oZWFkZXIudHdpZ2xldFRhYi5kZWxldGVUd2lnbGV0SWZOZWVkZWQodHdpZ2xldE5hbWUsIHBhZ2UpO1xuICAgIGJyb3dzZXIud2FpdEZvckFuZ3VsYXIoKTtcbiAgICBjcmVhdGVEZWZhdWx0SnNvbkltcG9ydGVkVHdpZ2xldChwYWdlKTtcbiAgICBicm93c2VyLndhaXRGb3JBbmd1bGFyKCk7XG4gIH0pO1xuXG4gIGFmdGVyQWxsKCgpID0+IHtcbiAgICAvLyBicm93c2VyLm1hbmFnZSgpLmxvZ3MoKS5nZXQoJ2Jyb3dzZXInKS50aGVuKGZ1bmN0aW9uKGJyb3dzZXJMb2cpIHtcbiAgICAvLyAgIGNvbnNvbGUubG9nKCdsb2c6ICcgKyByZXF1aXJlKCd1dGlsJykuaW5zcGVjdChicm93c2VyTG9nKSk7XG4gICAgLy8gfSk7XG4gICAgZGVsZXRlRGVmYXVsdEpzb25JbXBvcnRlZFR3aWdsZXQocGFnZSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBZGRpbmcgYW4gZXZlbnQnLCAoKSA9PiB7XG4gICAgYmVmb3JlQWxsKCgpID0+IHtcbiAgICAgIHBhZ2UuYWNjb3JkaW9uLmdvVG9NZW51KCdFdmVudHMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdwb3BzIHVwIHRoZSBjcmVhdGUgZXZlbnQgbW9kYWwnLCAoKSA9PiB7XG4gICAgICBwYWdlLmFjY29yZGlvbi5ldmVudHNNZW51LnN0YXJ0TmV3RXZlbnRQcm9jZXNzKCk7XG4gICAgICBleHBlY3QocGFnZS5mb3JtRm9yTW9kYWxzLm1vZGFsVGl0bGUpLnRvRXF1YWwoJ0NyZWF0ZSBOZXcgRXZlbnQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdtYWtlcyBzdXJlIGV2ZW50IG5hbWVzIGFyZSB1bmlxdWUnLCAoKSA9PiB7XG4gICAgICBwYWdlLmZvcm1Gb3JNb2RhbHMuZmlsbEluVGV4dEZpZWxkQnlMYWJlbCgnTmFtZScsICdldmVudDEnKTtcbiAgICAgIGV4cGVjdChwYWdlLmZvcm1Gb3JNb2RhbHMuZ2V0RXJyb3JCeUxhYmVsKCdOYW1lJykpLnRvRXF1YWwoJ05hbWVzIG11c3QgYmUgdW5pcXVlLicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2NhbiBzYXZlIHRoZSBldmVudCcsICgpID0+IHtcbiAgICAgIHBhZ2UuZm9ybUZvck1vZGFscy5maWxsSW5UZXh0RmllbGRCeUxhYmVsKCdOYW1lJywgJ2V2ZW50MycpO1xuICAgICAgcGFnZS5mb3JtRm9yTW9kYWxzLmNsaWNrQnV0dG9uKCdDcmVhdGUnKTtcbiAgICAgIHBhZ2UuZm9ybUZvck1vZGFscy53YWl0Rm9yTW9kYWxUb0Nsb3NlKCk7XG4gICAgICBwYWdlLmZvcm1Gb3JNb2RhbHMud2FpdEZvck1vZGFsVG9DbG9zZSgpO1xuICAgICAgZXhwZWN0KHBhZ2UuZm9ybUZvck1vZGFscy5pc01vZGFsT3BlbikudG9CZUZhbHN5KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnYWRkcyB0aGUgZXZlbnQnLCAoKSA9PiB7XG4gICAgICBleHBlY3QocGFnZS5hY2NvcmRpb24uZXZlbnRzTWVudS5ldmVudENvdW50KS50b0VxdWFsKDMpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUHJldmlld2luZyBhbiBldmVudCcsICgpID0+IHtcbiAgICBiZWZvcmVBbGwoKCkgPT4ge1xuICAgICAgYnJvd3Nlci53YWl0Rm9yQW5ndWxhcigpO1xuICAgICAgcGFnZS5oZWFkZXIudHdpZ2xldEVkaXRUYWIuc3RhcnRUd2lnbGV0RWRpdFByb2Nlc3MoKTtcbiAgICAgIHBhZ2UuaGVhZGVyLnR3aWdsZXRFZGl0VGFiLmFkZE5vZGVCeVRvb2x0aXAoJ2VudDEnKTtcbiAgICAgIHBhZ2UuZm9ybUZvck1vZGFscy5maWxsSW5UZXh0RmllbGRCeUxhYmVsKCdOYW1lJywgJ25vZGUgMScpO1xuICAgICAgcGFnZS5mb3JtRm9yTW9kYWxzLmNsaWNrQnV0dG9uKCdBZGQgTm9kZScpO1xuICAgICAgcGFnZS5mb3JtRm9yTW9kYWxzLndhaXRGb3JNb2RhbFRvQ2xvc2UoKTtcbiAgICAgIHBhZ2UuaGVhZGVyLnR3aWdsZXRFZGl0VGFiLnNhdmVFZGl0cygpO1xuICAgICAgcGFnZS5mb3JtRm9yTW9kYWxzLmZpbGxJbk9ubHlUZXh0RmllbGQoJ0NvbW1pdCBtZXNzYWdlJyk7XG4gICAgICBwYWdlLmZvcm1Gb3JNb2RhbHMuY2xpY2tCdXR0b24oJ1NhdmUgQ2hhbmdlcycpO1xuICAgICAgcGFnZS5mb3JtRm9yTW9kYWxzLndhaXRGb3JNb2RhbFRvQ2xvc2UoKTtcbiAgICAgIHBhZ2UuYWNjb3JkaW9uLmdvVG9NZW51KCdFdmVudHMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG93cyB0aGUgY29ycmVjdCBudW1iZXIgb2Ygbm9kZXMgZm9yIGV2ZW50JywgKCkgPT4ge1xuICAgICAgcGFnZS5hY2NvcmRpb24uZXZlbnRzTWVudS5wcmV2aWV3RXZlbnQoJ2V2ZW50MicpO1xuICAgICAgZXhwZWN0KHBhZ2UudHdpZ2xldEdyYXBoLm5vZGVDb3VudCkudG9FcXVhbCgxNSk7XG4gICAgICBwYWdlLmFjY29yZGlvbi5ldmVudHNNZW51LnByZXZpZXdFdmVudCgnZXZlbnQyJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDcmVhdGluZyBhIHNlcXVlbmNlJywgKCkgPT4ge1xuICAgIGl0KCdjYW4gY3JlYXRlIGEgc2VxdWVuY2UnLCAoKSA9PiB7XG4gICAgICBwYWdlLmFjY29yZGlvbi5ldmVudHNNZW51LnN0YXJ0TmV3RXZlbnRQcm9jZXNzKCk7XG4gICAgICBwYWdlLmZvcm1Gb3JNb2RhbHMuZmlsbEluVGV4dEZpZWxkQnlMYWJlbCgnTmFtZScsICdldmVudDQnKTtcbiAgICAgIHBhZ2UuZm9ybUZvck1vZGFscy5jbGlja0J1dHRvbignQ3JlYXRlJyk7XG4gICAgICBwYWdlLmZvcm1Gb3JNb2RhbHMud2FpdEZvck1vZGFsVG9DbG9zZSgpO1xuICAgICAgcGFnZS5hY2NvcmRpb24uZXZlbnRzTWVudS50b2dnbGVFdmVudENoZWNrKCdldmVudDEnKTtcbiAgICAgIHBhZ2UuYWNjb3JkaW9uLmV2ZW50c01lbnUudG9nZ2xlRXZlbnRDaGVjaygnZXZlbnQzJyk7XG4gICAgICBwYWdlLmFjY29yZGlvbi5ldmVudHNNZW51LnN0YXJ0TmV3U2VxdWVuY2VQcm9jZXNzKCk7XG4gICAgICBleHBlY3QocGFnZS5mb3JtRm9yTW9kYWxzLm1vZGFsVGl0bGUpLnRvRXF1YWwoJ0NyZWF0ZSBOZXcgU2VxdWVuY2UnKTtcbiAgICB9KTtcblxuICAgIGl0KCdtYWtlcyBzdXJlIGV2ZW50IHNlcXVlbmNlIG5hbWVzIGFyZSB1bmlxdWUnLCAoKSA9PiB7XG4gICAgICBwYWdlLmZvcm1Gb3JNb2RhbHMuZmlsbEluVGV4dEZpZWxkQnlMYWJlbCgnTmFtZScsICdzZXF1ZW5jZTEnKTtcbiAgICAgIGV4cGVjdChwYWdlLmZvcm1Gb3JNb2RhbHMuZ2V0RXJyb3JCeUxhYmVsKCdOYW1lJykpLnRvRXF1YWwoJ05hbWVzIG11c3QgYmUgdW5pcXVlLicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2NhbiBzYXZlIHRoZSBzZXF1ZW5jZScsICgpID0+IHtcbiAgICAgIHBhZ2UuZm9ybUZvck1vZGFscy5maWxsSW5UZXh0RmllbGRCeUxhYmVsKCdOYW1lJywgJ3NlcXVlbmNlMicpO1xuICAgICAgcGFnZS5mb3JtRm9yTW9kYWxzLmNsaWNrQnV0dG9uKCdDcmVhdGUnKTtcbiAgICAgIHBhZ2UuZm9ybUZvck1vZGFscy53YWl0Rm9yTW9kYWxUb0Nsb3NlKCk7XG4gICAgICBleHBlY3QocGFnZS5mb3JtRm9yTW9kYWxzLmlzTW9kYWxPcGVuKS50b0JlRmFsc3koKTtcbiAgICB9KTtcblxuICAgIGl0KCdzZXF1ZW5jZSBsaXN0IHNob3VsZCBkaXNwbGF5IHRoZSBjb3JyZWN0IG51bWJlciBvZiBzZXF1ZW5jZXMnLCAoKSA9PiB7XG4gICAgICBleHBlY3QocGFnZS5hY2NvcmRpb24uZXZlbnRzTWVudS5zZXF1ZW5jZUNvdW50KS50b0VxdWFsKDIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVmlld2luZyBhIHNlcXVlbmNlJywgKCkgPT4ge1xuICAgIGl0KCdzaG93cyB0aGUgY29ycmVjdCBjaGVja2VkIGV2ZW50cycsICgpID0+IHtcbiAgICAgIGV4cGVjdChwYWdlLmFjY29yZGlvbi5ldmVudHNNZW51LmNoZWNrZWRFdmVudCgnZXZlbnQzJykpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcblxuICAgIGl0KCdlbmRzIHRoZSBwbGF5IHNlcXVlbmNlIGFuZCBkaXNwbGF5cyBjdXJyZW50IHR3aWdsZXQnLCAoKSA9PiB7XG4gICAgICBwYWdlLmFjY29yZGlvbi5ldmVudHNNZW51LnN0YXJ0U2VxdWVuY2VQbGF5KCk7XG4gICAgICBwYWdlLmFjY29yZGlvbi5ldmVudHNNZW51LndhaXRGb3JQbGF5YmFjaygpO1xuICAgICAgZXhwZWN0KHBhZ2UudHdpZ2xldEdyYXBoLmxpbmtDb3VudCkudG9FcXVhbCgxNSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdPdmVyd3JpdGluZyBhIHNlcXVlbmNlJywgKCkgPT4ge1xuICAgIGl0KCdicmluZ3MgdXAgdGhlIHNhdmUgc2VxdWVuY2UgbW9kYWwgd2hlbiBzYXZlIGlzIGNsaWNrZWQnLCAoKSA9PiB7XG4gICAgICBwYWdlLmFjY29yZGlvbi5ldmVudHNNZW51LnN0YXJ0Vmlld1NlcXVlbmNlUHJvY2Vzcygnc2VxdWVuY2UyJyk7XG4gICAgICBwYWdlLmFjY29yZGlvbi5ldmVudHNNZW51LnRvZ2dsZUV2ZW50Q2hlY2soJ2V2ZW50MScpO1xuICAgICAgcGFnZS5hY2NvcmRpb24uZXZlbnRzTWVudS5zdGFydFNhdmVTZXF1ZW5jZVByb2Nlc3MoJ3NlcXVlbmNlMicpO1xuICAgICAgZXhwZWN0KHBhZ2UuZm9ybUZvck1vZGFscy5tb2RhbFRpdGxlKS50b0VxdWFsKCdFZGl0IFNlcXVlbmNlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnY2xvc2VzIHRoZSBtb2RhbCB3aGVuIHN1Ym1pdCBpcyBjbGlja2VkJywgKCkgPT4ge1xuICAgICAgcGFnZS5mb3JtRm9yTW9kYWxzLmNsaWNrQnV0dG9uKCdTYXZlIENoYW5nZXMnKTtcbiAgICAgIHBhZ2UuZm9ybUZvck1vZGFscy53YWl0Rm9yTW9kYWxUb0Nsb3NlKCk7XG4gICAgICBicm93c2VyLndhaXRGb3JBbmd1bGFyKCk7XG4gICAgICBleHBlY3QocGFnZS5mb3JtRm9yTW9kYWxzLmlzTW9kYWxPcGVuKS50b0JlRmFsc3koKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG93cyB0aGUgdXBkYXRlZCBjaGVja2VkIGV2ZW50cycsICgpID0+IHtcbiAgICAgIHBhZ2UuYWNjb3JkaW9uLmV2ZW50c01lbnUuc3RhcnRWaWV3U2VxdWVuY2VQcm9jZXNzKCdzZXF1ZW5jZTInKTtcbiAgICAgIGV4cGVjdChwYWdlLmFjY29yZGlvbi5ldmVudHNNZW51LmNoZWNrZWRFdmVudCgnZXZlbnQzJykpLnRvQmVGYWxzeSgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRGVsZXRpbmcgYW4gZXZlbnQnLCAoKSA9PiB7XG4gICAgYmVmb3JlQWxsKCgpID0+IHtcbiAgICAgIHBhZ2UuYWNjb3JkaW9uLmdvVG9NZW51KCdFdmVudHMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdkaXNhYmxlcyB0aGUgZGVsZXRlIGJ1dHRvbiBpZiBldmVudCBpcyBpbiBzZXF1ZW5jZScsICgpID0+IHtcbiAgICAgIGV4cGVjdChwYWdlLmFjY29yZGlvbi5ldmVudHNNZW51LmNoZWNrSWZEZWxldGVFbmFibGVkKCdldmVudDEnKSkudG9CZVRydXRoeSgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2NhbiBicmluZyB1cCB0aGUgZGVsZXRlIGV2ZW50IG1vZGFsJywgKCkgPT4ge1xuICAgICAgcGFnZS5hY2NvcmRpb24uZXZlbnRzTWVudS5zdGFydERlbGV0ZUV2ZW50UHJvY2VzcygnZXZlbnQ0Jyk7XG4gICAgICBleHBlY3QocGFnZS5mb3JtRm9yTW9kYWxzLm1vZGFsVGl0bGUpLnRvRXF1YWwoJ0RlbGV0ZSBldmVudDQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdkaXNhYmxlcyB0aGUgXCJEZWxldGVcIiBidXR0b24gaWYgdGhlIG5hbWUgZG9lcyBub3QgbWF0Y2gnLCAoKSA9PiB7XG4gICAgICBleHBlY3QocGFnZS5mb3JtRm9yTW9kYWxzLmNoZWNrSWZCdXR0b25FbmFibGVkKCdEZWxldGUnKSkudG9CZUZhbHN5KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZW5hYmxlcyB0aGUgYnV0dG9uIGlmIHRoZSBmb3JtIGlzIGZpbGxlZCBvdXQgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgcGFnZS5mb3JtRm9yTW9kYWxzLmZpbGxJbk9ubHlUZXh0RmllbGQoJ2V2ZW50NCcpO1xuICAgICAgZXhwZWN0KHBhZ2UuZm9ybUZvck1vZGFscy5jaGVja0lmQnV0dG9uRW5hYmxlZCgnRGVsZXRlJykpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2xvc2UgdGhlIG1vZGFsIHdoZW4gdGhlIERlbGV0ZSBidXR0b24gaXMgcHJlc3NlZCcsICgpID0+IHtcbiAgICAgIHBhZ2UuZm9ybUZvck1vZGFscy5jbGlja0J1dHRvbignRGVsZXRlJyk7XG4gICAgICBwYWdlLmZvcm1Gb3JNb2RhbHMud2FpdEZvck1vZGFsVG9DbG9zZSgpO1xuICAgICAgZXhwZWN0KHBhZ2UuZm9ybUZvck1vZGFscy5pc01vZGFsT3BlbikudG9CZUZhbHN5KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGVsZXRlcyB0aGUgZXZlbnQnLCAoKSA9PiB7XG4gICAgICBleHBlY3QocGFnZS5hY2NvcmRpb24uZXZlbnRzTWVudS5ldmVudENvdW50KS50b0VxdWFsKDMpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRGVsZXRpbmcgYSBzZXF1ZW5jZScsICgpID0+IHtcbiAgICBiZWZvcmVBbGwoKCkgPT4ge1xuICAgICAgcGFnZS5hY2NvcmRpb24uZ29Ub01lbnUoJ0V2ZW50cycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2NhbiBicmluZyB1cCB0aGUgZGVsZXRlIHNlcXVlbmNlIG1vZGFsJywgKCkgPT4ge1xuICAgICAgcGFnZS5hY2NvcmRpb24uZXZlbnRzTWVudS5zdGFydERlbGV0ZVNlcXVlbmNlUHJvY2Vzcygnc2VxdWVuY2UyJyk7XG4gICAgICBleHBlY3QocGFnZS5mb3JtRm9yTW9kYWxzLm1vZGFsVGl0bGUpLnRvRXF1YWwoJ0RlbGV0ZSBzZXF1ZW5jZTInKTtcbiAgICB9KTtcblxuICAgIGl0KCdkaXNhYmxlcyB0aGUgXCJEZWxldGVcIiBidXR0b24gaWYgdGhlIG5hbWUgZG9lcyBub3QgbWF0Y2gnLCAoKSA9PiB7XG4gICAgICBleHBlY3QocGFnZS5mb3JtRm9yTW9kYWxzLmNoZWNrSWZCdXR0b25FbmFibGVkKCdEZWxldGUnKSkudG9CZUZhbHN5KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZW5hYmxlcyB0aGUgYnV0dG9uIGlmIHRoZSBmb3JtIGlzIGZpbGxlZCBvdXQgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgcGFnZS5mb3JtRm9yTW9kYWxzLmZpbGxJbk9ubHlUZXh0RmllbGQoJ3NlcXVlbmNlMicpO1xuICAgICAgZXhwZWN0KHBhZ2UuZm9ybUZvck1vZGFscy5jaGVja0lmQnV0dG9uRW5hYmxlZCgnRGVsZXRlJykpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2xvc2UgdGhlIG1vZGFsIHdoZW4gdGhlIERlbGV0ZSBidXR0b24gaXMgcHJlc3NlZCcsICgpID0+IHtcbiAgICAgIHBhZ2UuZm9ybUZvck1vZGFscy5jbGlja0J1dHRvbignRGVsZXRlJyk7XG4gICAgICBwYWdlLmZvcm1Gb3JNb2RhbHMud2FpdEZvck1vZGFsVG9DbG9zZSgpO1xuICAgICAgZXhwZWN0KHBhZ2UuZm9ybUZvck1vZGFscy5pc01vZGFsT3BlbikudG9CZUZhbHN5KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGVsZXRlcyB0aGUgc2VxdWVuY2UnLCAoKSA9PiB7XG4gICAgICBleHBlY3QocGFnZS5hY2NvcmRpb24uZXZlbnRzTWVudS5zZXF1ZW5jZUNvdW50KS50b0VxdWFsKDEpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19